(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{15242:function(e,t,s){Promise.resolve().then(s.bind(s,57340))},57340:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(57437),r=s(2265),n=s(66070),i=s(95452),l=s(12339),c=s(47625),o=s(75169),d=s(3574),u=s(20407),f=s(8147),x=s(21156),m=s(56940),h=s(97059),j=s(62994),p=s(54061),b=s(70236),g=s(89048),v=s(35974);let N=["#0088FE","#00C49F","#FFBB28","#FF8042"];function y(){let[e,t]=(0,r.useState)(null),s=(0,i.createClientComponentClient)();(0,r.useEffect)(()=>{y()},[]);let y=async()=>{try{let{count:e}=await s.from("clientes").select("*",{count:"exact"}),{count:a}=await s.from("vehiculos").select("*",{count:"exact"}),{count:r}=await s.from("citas").select("*",{count:"exact"}).eq("estado","pendiente"),n=new Date().toISOString().split("T")[0],{count:i}=await s.from("citas").select("*",{count:"exact"}).gte("fecha_hora",n).lt("fecha_hora",n+"T23:59:59"),{data:l}=await s.from("citas").select("estado, count").select("estado").then(e=>{let{data:t}=e,s={};return null==t||t.forEach(e=>{s[e.estado]=(s[e.estado]||0)+1}),{data:Object.entries(s).map(e=>{let[t,s]=e;return{estado:t,cantidad:s}})}}),{data:c}=await s.from("citas").select("fecha_hora, estado").eq("estado","completada").then(e=>{let{data:t}=e,s={};return null==t||t.forEach(e=>{let t=new Date(e.fecha_hora).toLocaleString("es",{month:"long"});s[t]=(s[t]||0)+Math.floor(4e3*Math.random()+1e3)}),{data:Object.entries(s).map(e=>{let[t,s]=e;return{mes:t,ingresos:s}})}}),o=new Date;o.setHours(0,0,0,0);let d=new Date(o);d.setDate(d.getDate()+4);let{data:u}=await s.from("citas").select("\n          id_uuid,\n          fecha_hora,\n          estado,\n          clientes (\n            nombre\n          ),\n          servicios (\n            nombre\n          )\n        ");console.log("Citas obtenidas:",u);let f=(null==u?void 0:u.map(e=>({id_uuid:e.id_uuid,fecha_hora:e.fecha_hora,estado:e.estado,cliente:{nombre:e.clientes.nombre||"Error al cargar cliente"},servicios:e.servicios?[{nombre:e.servicios.nombre}]:[]})))||[];console.log("Citas formateadas:",f),t({totalClientes:e||0,totalVehiculos:a||0,citasPendientes:r||0,citasHoy:i||0,serviciosPorEstado:l||[],ingresosMensuales:c||[],proximasCitas:f})}catch(e){console.error("Error cargando datos:",e)}};return e?(0,a.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between space-y-2",children:(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"})}),(0,a.jsxs)(l.mQ,{defaultValue:"overview",className:"space-y-4",children:[(0,a.jsxs)(l.dr,{children:[(0,a.jsx)(l.SP,{value:"overview",children:"Vista General"}),(0,a.jsx)(l.SP,{value:"analytics",children:"Anal\xedticas"})]}),(0,a.jsxs)(l.nU,{value:"overview",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Clientes"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.totalClientes})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Veh\xedculos Registrados"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.totalVehiculos})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Citas Pendientes"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.citasPendientes})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Citas Hoy"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.citasHoy})})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{className:"col-span-1",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Servicios por Estado"})}),(0,a.jsx)(n.aY,{className:"pl-2",children:(0,a.jsx)(c.h,{width:"100%",height:300,children:(0,a.jsxs)(o.u,{children:[(0,a.jsx)(d.b,{data:e.serviciosPorEstado,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:s}=e;return"".concat(t," (").concat((100*s).toFixed(0),"%)")},outerRadius:80,fill:"#8884d8",dataKey:"cantidad",children:e.serviciosPorEstado.map((e,t)=>(0,a.jsx)(u.b,{fill:N[t%N.length]},"cell-".concat(t)))}),(0,a.jsx)(f.u,{})]})})})]}),(0,a.jsxs)(n.Zb,{className:"col-span-1",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Ingresos Mensuales"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)(c.h,{width:"100%",height:300,children:(0,a.jsxs)(x.w,{data:e.ingresosMensuales,children:[(0,a.jsx)(m.q,{strokeDasharray:"3 3"}),(0,a.jsx)(h.K,{dataKey:"mes"}),(0,a.jsx)(j.B,{}),(0,a.jsx)(f.u,{}),(0,a.jsx)(p.x,{type:"monotone",dataKey:"ingresos",stroke:"#8884d8"})]})})})]})]}),(0,a.jsxs)(n.Zb,{className:"col-span-2",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"Pr\xf3ximas Citas"})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[e.proximasCitas.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-accent/10 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.cliente.nombre}),(0,a.jsx)(v.C,{variant:"completada"===e.estado?"success":"cancelada"===e.estado?"destructive":"confirmada"===e.estado?"default":"secondary",children:e.estado})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(null===(t=e.servicios[0])||void 0===t?void 0:t.nombre)||"Sin servicio"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end text-sm",children:[(0,a.jsx)("p",{className:"font-medium",children:(0,b.Z)(new Date(e.fecha_hora),"d 'de' MMMM",{locale:g.Z})}),(0,a.jsx)("p",{className:"text-muted-foreground",children:(0,b.Z)(new Date(e.fecha_hora),"HH:mm",{locale:g.Z})})]})]},e.id_uuid)}),0===e.proximasCitas.length&&(0,a.jsx)("div",{className:"text-center py-6 text-muted-foreground",children:"No hay citas programadas para los pr\xf3ximos d\xedas"})]})})]})]})]})]}):(0,a.jsx)("div",{children:"Cargando..."})}},35974:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(57437);s(2265);var r=s(90535),n=s(94508);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",info:"border-transparent bg-blue-100 text-blue-800"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var a=s(57437),r=s(2265),n=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});i.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent"},12339:function(e,t,s){"use strict";s.d(t,{SP:function(){return o},dr:function(){return c},mQ:function(){return l},nU:function(){return d}});var a=s(57437),r=s(2265),n=s(20271),i=s(94508);let l=n.fC,c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});c.displayName=n.aV.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});o.displayName=n.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});d.displayName=n.VY.displayName},94508:function(e,t,s){"use strict";s.d(t,{S:function(){return i},cn:function(){return n}});var a=s(61994),r=s(53335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}function i(){return"/edgarai"}}},function(e){e.O(0,[9903,8325,5452,2130,276,5098,1788,2971,2117,1744],function(){return e(e.s=15242)}),_N_E=e.O()}]);